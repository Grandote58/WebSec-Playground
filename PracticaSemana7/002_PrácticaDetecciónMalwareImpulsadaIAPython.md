# **Práctica: Detección de Malware Impulsada por IA con Python**

## Objetivo:

El objetivo de esta práctica es crear un modelo simple de detección de malware utilizando técnicas de aprendizaje automático. Los estudiantes aprenderán a cargar un conjunto de datos, preprocesar los datos, entrenar un modelo y evaluar su rendimiento.

## Requisitos Previos:

- Conocimientos básicos de Python.
- Familiaridad con bibliotecas como `pandas`, `scikit-learn`, y `matplotlib`.
- Conocimiento básico de aprendizaje automático y clasificación.

## Pasos:

### 1. **Instalación de Bibliotecas Necesarias**

Primero, asegúrate de que las bibliotecas necesarias estén instaladas. Puedes instalar estas bibliotecas ejecutando los siguientes comandos en tu terminal o entorno de desarrollo:

```bash
!pip install pandas scikit-learn matplotlib
```

### 2. **Carga y Exploración del Conjunto de Datos**

Vamos a utilizar un conjunto de datos simplificado donde cada muestra está etiquetada como "benigno" o "maligno". Este dataset es un ejemplo y contiene características que podrían representar comportamientos de archivos o procesos.

```python
import pandas as pd

# Cargar el conjunto de datos
# https://www.kaggle.com/datasets/nsaravana/malware-detection
url = "https://raw.githubusercontent.com/jbrownlee/Datasets/master/malware.csv"
data = pd.read_csv(url)

# Mostrar las primeras filas del conjunto de datos
print(data.head())
```

**Documentación:**

- **pandas:** Biblioteca utilizada para la manipulación y análisis de datos.
- **data.head():** Muestra las primeras 5 filas del conjunto de datos para dar una idea de la estructura.

### 3. **Preprocesamiento de Datos**

Antes de entrenar el modelo, es necesario preprocesar los datos. Esto incluye convertir etiquetas categóricas en valores numéricos y dividir el conjunto de datos en conjuntos de entrenamiento y prueba.

```python
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder

# Convertir etiquetas categóricas a numéricas
label_encoder = LabelEncoder()
data['Class'] = label_encoder.fit_transform(data['Class'])

# Separar características y etiquetas
X = data.drop('Class', axis=1)
y = data['Class']

# Dividir los datos en conjunto de entrenamiento y prueba
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

print(f"Conjunto de entrenamiento: {X_train.shape}")
print(f"Conjunto de prueba: {X_test.shape}")
```

**Documentación:**

- **LabelEncoder:** Convierte etiquetas categóricas en valores numéricos.
- **train_test_split:** Divide los datos en conjuntos de entrenamiento y prueba.

### 4. **Entrenamiento del Modelo de Aprendizaje Automático**

En este paso, entrenaremos un modelo simple de clasificación utilizando un clasificador de Bosques Aleatorios (Random Forest).

```python
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score

# Crear y entrenar el modelo
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)

# Predecir en el conjunto de prueba
y_pred = model.predict(X_test)

# Evaluar la precisión del modelo
accuracy = accuracy_score(y_test, y_pred)
print(f"Precisión del modelo: {accuracy:.2f}")
```

**Documentación:**

- **RandomForestClassifier:** Modelo de clasificación basado en el algoritmo de Bosques Aleatorios.
- **accuracy_score:** Mide la precisión del modelo, que es la proporción de predicciones correctas.

### 5. **Visualización de la Importancia de las Características**

Es importante comprender qué características son más relevantes para el modelo. A continuación, visualizaremos la importancia de las características.

```python
import matplotlib.pyplot as plt

# Obtener la importancia de las características
importances = model.feature_importances_
indices = pd.Series(importances, index=X.columns).sort_values(ascending=False)

# Visualizar la importancia de las características
plt.figure(figsize=(10, 6))
indices.plot(kind='bar')
plt.title("Importancia de las Características")
plt.xlabel("Características")
plt.ylabel("Importancia Relativa")
plt.show()
```

**Documentación:**

- **feature_importances_:** Atributo del modelo que muestra la importancia de cada característica en la predicción.
- **matplotlib:** Biblioteca utilizada para crear gráficos y visualizaciones.

### 6. **Conclusión y Reflexión**

En esta práctica, hemos construido un modelo de detección de malware utilizando técnicas de aprendizaje automático. Aunque el modelo es simple, proporciona una base sólida para entender cómo se pueden aplicar modelos de IA en la ciberseguridad.

### Reflexión:

- **Limitaciones:** Es importante tener en cuenta que este modelo es un ejemplo simplificado. En un entorno real, los modelos de detección de malware necesitan ser más complejos y deben ser entrenados en conjuntos de datos más grandes y representativos.